import{_ as a}from"./ShowCode-711ce689.js";import{_ as o,o as r,c as d,e as s,B as c,z as u,A as l,a as e,d as i}from"./index-d59bb747.js";const p="/access/medias/icud.png",m="/access/medias/icud_c1.png",v="/access/medias/icud_c2.png",_="/access/medias/icud_c3.png",b="/access/medias/icud_i1.png",f="/access/medias/icud_i2.png",g="/access/medias/icud_i3.png",h="/access/medias/icud_i4.png",z="/access/medias/icud_i5.png",q="/access/medias/icud_i6.png",C="/access/medias/icud_i7.png";const t=n=>(u("data-v-c0b9706a"),n=n(),l(),n),j=c('<p data-v-c0b9706a> Ici, nous allons permettre d&#39;interagir avec la zone de liste créée dans le chapitre précédent. J&#39;insiste sur le terme &quot;avancé&quot; car nous allons utiliser beaucoup de VBA. J&#39;essaierai d&#39;expliquer au mieux. </p><p data-v-c0b9706a>Commencez par créer 4 boutons :</p><ul data-v-c0b9706a><li data-v-c0b9706a><span data-v-c0b9706a>Un pour l&#39;importation d&#39;une adresse e-mail (par importation, j&#39;entends ajouter un e-mail qui existe déjà)</span></li><li data-v-c0b9706a><span data-v-c0b9706a>Un pour la création d&#39;une adresse e-mail</span></li><li data-v-c0b9706a><span data-v-c0b9706a>Un pour la suppression d&#39;une adresse e-mail</span></li><li data-v-c0b9706a><span data-v-c0b9706a>Un pour l&#39;édition d&#39;une adresse e-mail</span></li></ul><img src="'+p+'" data-v-c0b9706a><p data-v-c0b9706a> Choisissez des icônes qui vous parlent. Ne leur donnez pas de fonctions pour l&#39;instant. </p><h2 data-v-c0b9706a>Ajouter une adresse</h2><p data-v-c0b9706a>Commençons par le bouton permettant d&#39;ajouter une adresse e-mail.</p><p data-v-c0b9706a>Il faut utiliser l&#39;assistant de formulaire et inclure aussi l&#39;ID :</p><img src="'+m+'" data-v-c0b9706a><p data-v-c0b9706a> Nommez le formulaire F_Ajouter_Email car nous devrons en faire un par fonction. </p><p data-v-c0b9706a> Ajoutez-y un bouton avec la fonction <i data-v-c0b9706a>Sauvegarder un enregistrement</i> : </p><img src="'+v+'" data-v-c0b9706a><p data-v-c0b9706a> Maintenant, passons aux choses sérieuses. Allez dans les propriétés du formulaire, et, sous <i data-v-c0b9706a>Événement</i>, cliquez sur <i data-v-c0b9706a>Après insertion</i> : </p><img src="'+_+'" data-v-c0b9706a><p data-v-c0b9706a>L&#39;éditeur VBA s&#39;ouvre. Collez-y le code suivant :</p>',15),x=c("<p data-v-c0b9706a>Explication du code :</p><p data-v-c0b9706a> La deuxième ligne (<code data-v-c0b9706a>DoCmd.RunSQL</code>) permet d&#39;exécuter une requête SQL. Pour faire simple, c&#39;est une manière de modifier la base de données depuis le code. Pensez a remplacer tous les noms de champs par les vôtres, sinon Access ne les trouvera pas. </p><p data-v-c0b9706a> Seulement, cette fonction affiche un avertissement, nous mettons donc la commande <code data-v-c0b9706a>DoCmd.SetWarnings False</code> avant afin de les désactiver et <code data-v-c0b9706a>DoCmd.SetWarnings True</code> pour les réactiver après. </p><p data-v-c0b9706a><code data-v-c0b9706a>DoCmd.Close</code> ferme simplement le formulaire, nous renvoyant ainsi vers le formulaire F_Personne. </p><p data-v-c0b9706a> Pour finir, on fait un <code data-v-c0b9706a>Requery</code> sur le champ Emails de F_Personne pour l&#39;actualiser et donc afficher la nouvelle adresse ajoutée. </p><p data-v-c0b9706a> Il faut ensuite retourner dans F_Personne et ajouter un évènement <i data-v-c0b9706a>Sur clic</i> au bouton + : </p>",6),A=c('<p data-v-c0b9706a>Cela ouvrira le formulaire F_Ajouter_Email.</p><h2 data-v-c0b9706a>Importer une adresse</h2><p data-v-c0b9706a> Importer n&#39;est peut-être pas le meilleur terme. Je veux dire par là, associer une adresse déjà existante à la personne. </p><p data-v-c0b9706a> Commencez par créer un nouveau formulaire avec l&#39;assistant. Nommez-le F_Importer_Email (par exemple), puis supprimez-y tous les champs. </p><p data-v-c0b9706a>À la place, insérez une <i data-v-c0b9706a>Zone de liste déroulante</i> :</p><img src="'+b+'" data-v-c0b9706a><p data-v-c0b9706a>Selectionnez T_Email :</p><img src="'+f+'" data-v-c0b9706a><p data-v-c0b9706a>Prenez au moins l&#39;ID et l&#39;adresse :</p><img src="'+g+'" data-v-c0b9706a><p data-v-c0b9706a> Il n&#39;y a plus grand chose à configurer par la suite, vous pouvez faire suivant, suivant, suivant... </p><img src="'+h+'" data-v-c0b9706a><img src="'+z+'" data-v-c0b9706a><img src="'+q+'" data-v-c0b9706a><img src="'+C+'" data-v-c0b9706a><p data-v-c0b9706a> Une fois la liste déroulante créée, ajoutez un bouton, dans <i data-v-c0b9706a>Événement</i> → <i data-v-c0b9706a>Sur clic</i>. Cela ouvre l&#39;éditeur VBA. </p><p data-v-c0b9706a> Vous pouvez y coller le même code que précédemment, à l&#39;exception de la requête SQL qui diffère un peu : </p>',17),S=t(()=>e("p",null," Et, ne pas oublier de donner un évènement au bouton v dans le formulaire F_Personne : ",-1)),I=t(()=>e("h2",null,"Supprimer une adresse",-1)),L=t(()=>e("p",null,[i(" Le bouton "),e("i",null,"Supprimer"),i(" n'aura pas pour effet de supprimer l'adresse, mais juste la relation entre la personne et l'adresse. ")],-1)),B=t(()=>e("p",null,[i(" Ici, pas besoin de créer de formulaire. Allez dans les propriétés du bouton et ajouté un l'événement "),e("i",null,"Sur clic"),i(" : ")],-1)),F=c("<p data-v-c0b9706a> Nous avons ici deux conditions. La première est qu&#39;il y ai un élément sélectionné dans la liste. La deuxième est que l&#39;utilisateur confirme la suppression. </p><p data-v-c0b9706a>Ensuite, ça lance du SQL comme avant et réactualise le champ.</p><p data-v-c0b9706a>Il vous faudra sûrement renommer quelques trucs pour que cela marche.</p><h2 data-v-c0b9706a>Modifier une adresse</h2><p data-v-c0b9706a> La modification est très proche de la création. Vous pouvez déjà copier-coller le formulaire F_Ajouter_Email et le renommer F_Modifier_Email. </p><p data-v-c0b9706a> Dans les événements, supprimez-le <i data-v-c0b9706a>Après insertion</i> et cliquez sur <i data-v-c0b9706a>Après MAJ</i>. </p><p data-v-c0b9706a> Le code est très simple, je pense qu&#39;il n&#39;y a même pas besoin de l&#39;expliquer : </p>",7),y=t(()=>e("p",null,"Il faut aussi mettre un peu de code sur le bouton d'édition :",-1)),E=t(()=>e("p",null,"Je fais juste un petit test pour voir si un élément est sélectionné.",-1)),V=t(()=>e("p",null,[i(" Voilà ! Tous les boutons devraient maintenant fonctionner. Le fichier est disponible "),e("a",{href:"/access/files/Database2.accdb"},"ici"),i(" si vous voulez vérifier ou comparer quelque chose. ")],-1)),D={__name:"ControlZoneListe",setup(n){return(N,P)=>(r(),d("div",null,[j,s(a,{file:"/access/code/Form_AfterInsert.vba",lang:"vba"}),x,s(a,{file:"/access/code/Btn_ajouter_email_Click.vba",lang:"vba"}),A,s(a,{file:"/access/code/Btn_selectionner_Click.vba",lang:"vba"}),S,s(a,{file:"/access/code/Btn_importer_email_Click.vba",lang:"vba"}),I,L,B,s(a,{file:"/access/code/Btn_supprimer_email_Click.vba",lang:"vba"}),F,s(a,{file:"/access/code/Form_AfterUpdate.vba",lang:"vba"}),y,s(a,{file:"/access/code/Btn_modifier_email_Click.vba",lang:"vba"}),E,V]))}},J=o(D,[["__scopeId","data-v-c0b9706a"]]);export{J as default};
