{"version":3,"sources":["webpack:///./src/views/access/ControlZoneListe.vue","webpack:///./src/views/access/ControlZoneListe.vue?23dd"],"names":["class","href","file","lang","name","components","ShowCode","__exports__","render"],"mappings":"wpDAwBOA,MAAM,yB,EACX,eAA4B,SAAzB,yBAAqB,G,EACxB,eAA4P,SAAzP,yPAAqP,G,EACxP,eAAiM,SAA9L,8LAA0L,G,EAC7L,eAA6G,SAA1G,0GAAsG,G,EACzG,eAAuI,SAApI,oIAAgI,G,EACnI,eAA+F,SAA5F,4FAAwF,G,GACtFA,MAAM,yB,0tCAmBNA,MAAM,yB,EACX,eAA0F,SAAvF,uFAAmF,G,GACjFA,MAAM,yB,EAEX,eAA8B,UAA1B,yBAAqB,G,EACzB,eAA+H,SAA5H,4HAAwH,G,EAC3H,eAAuH,SAApH,oHAAgH,G,GAC9GA,MAAM,yB,EACX,eAAkK,SAA/J,+JAA2J,G,EAC9J,eAAoE,SAAjE,iEAA6D,G,EAChE,eAA4E,SAAzE,yEAAqE,G,EAExE,eAA6B,UAAzB,wBAAoB,G,EACxB,eAAoJ,SAAjJ,iJAA6I,G,EAChJ,eAAkF,SAA/E,+EAA2E,G,EAC9E,eAAqF,SAAlF,kFAA8E,G,GAC5EA,MAAM,yB,EACX,eAAoE,SAAjE,iEAA6D,G,GAC3DA,MAAM,yB,EACX,eAA2E,SAAxE,wEAAoE,G,EAEvE,eAA0L,U,eAAvL,oFAAgF,eAAgD,KAA7CC,KAAK,kCAAiC,O,eAAO,yD,oFAtEpI,eAuEM,YAtEL,EAsBA,eAAkG,MAAlG,EAAkG,CAA/D,eAAyD,GAA/CC,KAAK,8BAA8BC,KAAK,UACrF,EACA,EACA,EACA,EACA,EACA,EACA,eAAyG,MAAzG,EAAyG,CAAtE,eAAgE,GAAtDD,KAAK,qCAAqCC,KAAK,UAC5F,EAkBA,eAAwG,MAAxG,EAAwG,CAArE,eAA+D,GAArDD,KAAK,oCAAoCC,KAAK,UAC3F,EACA,eAA0G,MAA1G,EAA0G,CAAvE,eAAiE,GAAvDD,KAAK,sCAAsCC,KAAK,UAE7F,EACA,EACA,EACA,eAA2G,MAA3G,EAA2G,CAAxE,eAAkE,GAAxDD,KAAK,uCAAuCC,KAAK,UAC9F,EACA,EACA,EAEA,EACA,EACA,EACA,EACA,eAAkG,MAAlG,EAAkG,CAA/D,eAAyD,GAA/CD,KAAK,8BAA8BC,KAAK,UACrF,EACA,eAA0G,MAA1G,EAA0G,CAAvE,eAAiE,GAAvDD,KAAK,sCAAsCC,KAAK,UAC7F,EAEA,I,gBAOc,GACdC,KAAM,mBACNC,WAAY,CACXC,WAAA,O,qBC5EH,MAAMC,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,KAErD","file":"js/chunk-2d2165b3.68f971f4.js","sourcesContent":["<template>\n\t<div>\n\t\t<h1>Importer, ajouter, modifier et supprimer des éléments d'une zone de liste (niveau avancé)</h1>\n\t\t<p>Ici, nous allons permettre d'interagir avec la zone de liste crée dans le chapitre précèdent. J'insiste sur le terme 'avancé' car nous allons utiliser beaucoup de VBA. J'essaierais d'expliquer au mieux.</p>\n\t\t<p>Commencez par créer 4 boutons :</p>\n\t\t<ul>\n\t\t\t<li>Un pour l'importation d'une adresse email (par importation, j'entends ajouter un email qui existe déjà)</li>\n\t\t\t<li>Un pour la création d'une adresse email</li>\n\t\t\t<li>Un pour la suppression d'une adresse email</li>\n\t\t\t<li>Un pour l'édition d'une adresse email</li>\n\t\t</ul>\n\t\t<img src=\"/medias/access/icud.png\" class=\"img-fluid\"/>\n\t\t<p>Choisissez des icônes qui vous parlent, ne leur donné pas de fonctions pour l'instant.</p>\n\n\t\t<h3>Ajouter une adresse</h3>\n\t\t<p>Commençons par le bouton permettant d'ajouter une adresse email.</p>\n\t\t<p>Il faut utiliser l'assistant de formulaire et inclure aussi l'ID :</p>\n\t\t<img src=\"/medias/access/icud_c1.png\" class=\"img-fluid\"/>\n\t\t<p>Nommez le formulaire F_Ajouter_Email, car nous devrons en faire un par fonction.</p>\n\t\t<p>Ajoutez-y un bouton avec la fonction Sauvegarder un enregistrement</p>\n\t\t<img src=\"/medias/access/icud_c2.png\" class=\"img-fluid\"/>\n\t\t<p>Maintenant, passons aux choses sérieuses. Allez dans les propriétés du formulaire, sous Événement, cliquer sur Après insertion</p>\n\t\t<img src=\"/medias/access/icud_c3.png\" class=\"img-fluid\"/>\n\t\t<p>L'éditeur VBA s'ouvre, collez-y le code suivant :</p>\n\t\t<pre class=\"language-visual-basic\"><ShowCode file=\"access/Form_AfterInsert.vba\" lang=\"vba\"/></pre>\n\t\t<p>Explication du code :</p>\n\t\t<p>La deuxième ligne (DoCmd.RunSQL) permet d'exécuter une requête SQL, pour faire simple, c'est une manière de modifier la base de données depuis le code. Pensez a remplacer tous les noms de champs par les vôtres, sinon Access ne les trouveras pas.</p>\n\t\t<p>Seulement, cette fonction affiche un avertissement, nous mettons donc la commande DoCmd.SetWarnings False avant afin de les désactiver et DoCmd.SetWarnings True après pour les réactiver.</p>\n\t\t<p>DoCmd.Close ferme simplement le formulaire donc on devrait être retourné sur le formulaire F_Personne.</p>\n\t\t<p>Pour finir, on fait un Requery sur le champ Emails de F_Personne pour l'actualiser et donc afficher la nouvelle adresse ajoutée.</p>\n\t\t<p>Il faut ensuite retourner dans F_Personne et ajouter un évènement Sur clic au bouton + :</p>\n\t\t<pre class=\"language-visual-basic\"><ShowCode file=\"access/Btn_ajouter_email_Click.vba\" lang=\"vba\"/></pre>\n\t\t<p>Cela ouvrira le formulaire F_Ajouter_Email</p>\n\n\t\t<h3>Importer une adresse</h3>\n\t\t<p>Importer n'est peut-être pas le meilleur terme. Je veux dire par là, associer une adresse déjà existante a la personne.</p>\n\t\t<p>Commencez par créer un nouveau formulaire avec l'assistant. Nommez le F_Importer_Email (par exemple) puis supprimez-y tous les champs.</p>\n\t\t<p>Insérez à la place une Zone de liste déroulante</p>\n\t\t<img src=\"/medias/access/icud_i1.png\" class=\"img-fluid\"/>\n\t\t<p>Selectionnez T_Email</p>\n\t\t<img src=\"/medias/access/icud_i2.png\" class=\"img-fluid\"/>\n\t\t<p>Prenez au moins l'ID et l'adresse</p>\n\t\t<img src=\"/medias/access/icud_i3.png\" class=\"img-fluid\"/>\n\t\t<p>Il n'y a plus grand chose à configurer par la suite, vous pouvez faire suivant, suivant, suivant...</p>\n\t\t<img src=\"/medias/access/icud_i4.png\" class=\"img-fluid\"/>\n\t\t<img src=\"/medias/access/icud_i5.png\" class=\"img-fluid\"/>\n\t\t<img src=\"/medias/access/icud_i6.png\" class=\"img-fluid\"/>\n\t\t<img src=\"/medias/access/icud_i7.png\" class=\"img-fluid\"/>\n\t\t<p>Une fois la liste déroulante créée, ajoutez un bouton, dans Événement, Sur clic, cela ouvre l'éditeur VBA.</p>\n\t\t<p>Vous pouvez y coller le même code que précédemment, à l'exception de la requête SQL qui diffère un peu.</p>\n\t\t<pre class=\"language-visual-basic\"><ShowCode file=\"access/Btn_selectionner_Click.vba\" lang=\"vba\"/></pre>\n\t\t<p>Et, ne pas oublier de donner un évènement au bouton v dans le formulaire F_Personne</p>\n\t\t<pre class=\"language-visual-basic\"><ShowCode file=\"access/Btn_importer_email_Click.vba\" lang=\"vba\"/></pre>\n\n\t\t<h3>Supprimer une adresse</h3>\n\t\t<p>Le bouton Supprimer n'aura pas pour effet de supprimer l'adresse, mais juste la relation entre la personne et l'adresse.</p>\n\t\t<p>Ici, pas besoin de créer de formulaire. Allez dans les propriétés du bouton - et ajouté un l'événement Sur clic.</p>\n\t\t<pre class=\"language-visual-basic\"><ShowCode file=\"access/Btn_supprimer_email_Click.vba\" lang=\"vba\"/></pre>\n\t\t<p>Nous avons ici 2 condition, la première c'est qu'il y ai un élément sélectionné dans la liste, la deuxième c'est que l'utilisateur confirme la suppression.</p>\n\t\t<p>Ensuite, ça lance du SQL comme avant et réactualise le champ.</p>\n\t\t<p>Il vous faudra surement renommer quelques trucs pour que cela marche.</p>\n\n\t\t<h3>Modifier une adresse</h3>\n\t\t<p>La modification est très proche de la création. Vous pouvez déjà copier-coller le formulaire F_Ajouter_Email et le renommer F_Modifier_Email.</p>\n\t\t<p>Dans les événements, supprimer le Après insertion et cliquez sur Après MAJ.</p>\n\t\t<p>Le code est très simple, je pense qu'il n'y a même pas besoin de l'expliquer :</p>\n\t\t<pre class=\"language-visual-basic\"><ShowCode file=\"access/Form_AfterUpdate.vba\" lang=\"vba\"/></pre>\n\t\t<p>Il faut aussi mettre un peu de code sur le bouton d'édition :</p>\n\t\t<pre class=\"language-visual-basic\"><ShowCode file=\"access/Btn_modifier_email_Click.vba\" lang=\"vba\"/></pre>\n\t\t<p>Je fais juste un petit test pour voir si un élément est sélectionné.</p>\n\n\t\t<p>Voilà, tous les boutons devraient maintenant marcher. Le fichier est disponible <a href=\"/medias/access/Database2.accdb\">ici</a> si vous voulez vérifier ou comparer quelque chose.</p>\n\t</div>\n</template>\n\n<script>\n\timport ShowCode from '../../components/ShowCode.vue'\n\n\texport default {\n\t\tname: 'ControlZoneListe',\n\t\tcomponents: {\n\t\t\tShowCode,\n\t\t},\n\t}\n</script>\n","import { render } from \"./ControlZoneListe.vue?vue&type=template&id=78ca329b\"\nimport script from \"./ControlZoneListe.vue?vue&type=script&lang=js\"\nexport * from \"./ControlZoneListe.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/home/runner/work/epsic.burkhalter.dev/epsic.burkhalter.dev/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}